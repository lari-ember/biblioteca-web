{% extends "base.html" %}

{#
  i18n TODO: Phase 2 - Extract all user-facing strings to Flask-Babel catalog
  Current implementation uses static pt-BR/en bilingual approach
  See docs/I18N_PREPARATION.md for migration guide
#}

{% set title = title or "Amber Archivily - Sua Biblioteca Digital Inteligente" %}
{% set description = description or "Sistema moderno de gerenciamento de biblioteca pessoal com recursos avan√ßados de cataloga√ß√£o, pesquisa e organiza√ß√£o de acervos f√≠sicos e digitais." %}

{# Importa√ß√£o dos componentes modulares #}
{% from "components/features_section.html" import features_header, features_grid, developer_section, welcome_dashboard, featured_books_section %}
{% include "components/features_config.html" %}

{% block content %}

{% if not current_user.is_authenticated %}
<!-- Hero Section para usu√°rios n√£o autenticados -->
<section class="hero-section" aria-label="Apresenta√ß√£o principal">
  <div class="hero-grid">
    <div class="hero-content">
      <h1 class="hero-title">Amber Archivily</h1>
      <p class="hero-subtitle">
        Um grim√≥rio digital encantado onde cada p√°gina sussurra hist√≥rias eternas. Desperte o que h√° em voc√™ e transforme sua cole√ß√£o em um santu√°rio liter√°rio, onde cada livro encontra seu lugar sagrado nas prateleiras do tempo.
      </p>
      <a href="#about" class="hero-cta" aria-describedby="hero-description">
        Adentrar o Reino dos Livros
      </a>
      <span id="hero-description" class="sr-only">
        Saiba mais sobre as funcionalidades m√°gicas do seu sistema de biblioteca pessoal
      </span>
    </div>
    <div class="hero-media">
      <img src="{{ url_for('static', filename='images/hero_banner.png') }}"
           class="hero-image d-none d-lg-block"
           alt=""
           aria-hidden="true">
    </div>
  </div>
</section>

<!-- About Section -->
<section class="about-section" id="about" aria-label="Sobre o projeto">
  <div class="container">
    <div class="about-container">
      <div class="about-image-wrapper">
        <img src="{{ url_for('static', filename='images/elevator_painting.jpg') }}"
             class="about-image"
             alt="Portal m√≠stico para uma biblioteca encantada onde livros flutuam em harmonia"
             loading="lazy">
      </div>

      <div class="about-content">
        <h2>A Cr√¥nica do Amber Archivily</h2>
        <h3>Sorva sua po√ß√£o favorita enquanto desbrava os corredores infinitos do conhecimento ‚ú®</h3>

        <p>
          <strong>Era uma vez...</strong> um reino onde os livros viviam em harmonia perfeita! Bem-vindos ao <em>Amber Archivily</em> - n√£o apenas um programa, mas um portal m√°gico que desperta a vida adormecida em sua biblioteca pessoal. Seja voc√™ um colecionador de pergaminhos antigos, um ca√ßador de mang√°s raros, ou um guardi√£o de light novels √©picas, este √© o seu destino liter√°rio.
        </p>

        <p>
          Como um verdadeiro <strong>Mestre dos Arquivos</strong>, voc√™ criar√° seu pr√≥prio reino bibliogr√°fico com poderes dignos de um bibliotec√°rio de Alexandria. Cada tome receber√° sua marca √∫nica - c√≥digos m√≠sticos baseados na ancestral <em>Classifica√ß√£o Decimal Universal</em>, onde t√≠tulo, escriba, editora, ano de nascimento e ess√™ncia (f√≠sica, digital ou et√©rea) ser√£o catalogados com precis√£o alqu√≠mica.
        </p>

        <p>
          <em>"Procura-se um livro perdido no labirinto das prateleiras?"</em> N√£o tema! Nosso sistema de busca √© mais eficiente que o pr√≥prio Sherlock Holmes em <strong>A Aventura da Biblioteca Perdida</strong>. Encontre qualquer volume por g√™nero, estado de leitura (em progresso, conquistado, ou aguardando na fila do destino) e at√© mesmo por status de empr√©stimo - porque sabemos que emprestar livros √© quase como enviar filhos para o mundo.
        </p>

        <p>
          Mas os encantamentos n√£o param por a√≠! Como um verdadeiro <strong>Arquivista Supremo</strong>, voc√™ comandar√° filtros e organiza√ß√µes que fariam inveja √† pr√≥pria <em>Biblioteca de Babel</em> de Borges. Ordene por escriba, casa editorial, ano de cria√ß√£o, extens√£o narrativa e muito mais. Acompanhe suas jornadas liter√°rias e marque os progressos √©picos como um mapa do tesouro pessoal.
        </p>

        <p>
          E para os <strong>S√°bios dos N√∫meros</strong> - aqueles que encontram magia nas estat√≠sticas! - o Amber Archivily conjura relat√≥rios m√≠sticos sobre seu reino liter√°rio: quantos volumes habitam cada g√™nero, qual escriba reina absoluto em seus dom√≠nios, e segredos numerol√≥gicos que s√≥ os verdadeiros bibli√≥filos compreendem.
        </p>

        <p>
          <em>Ent√£o, pegue sua bebida encantada, vista seu manto de leitor e adentrem...</em> Deixe que o Amber Archivily seja o guardi√£o eterno de seus tesouros liter√°rios, enquanto voc√™ se perde nas infinitas possibilidades que s√≥ uma biblioteca bem organizada pode oferecer! üìö‚ú®
        </p>
      </div>
    </div>
  </div>
</section>

<!-- Features Section MODULAR com novo sistema de cards -->
<main id="main" role="main">
  <section class="features-section" aria-label="Funcionalidades do sistema">
    <div class="container">
      {{ features_header(
        title="Os Quatro Pilares da Sabedoria",
        subtitle="Desvende os poderes ancestrais que aguardam em sua biblioteca pessoal"
      ) }}

      {{ features_grid(unauthenticated_features) }}

      {{ developer_section() }}
    </div>
  </section>

  <!-- Se√ß√£o de Livros em Destaque (Placeholder para implementa√ß√£o futura) -->
  {# {{ featured_books_section([]) }} #}
</main>

{% else %}
<!-- Dashboard para usu√°rios autenticados MODULAR -->
<main id="main-content" role="main">
  {{ welcome_dashboard(current_user) }}

  <!-- Features Grid para usu√°rios autenticados -->
  <section class="features-section" aria-label="Portais de acesso aos poderes bibliogr√°ficos" aria-live="polite">
    <div class="container">
      {% set authenticated_features = [
        {
          'id': 'auth-card-title-1',
          'eyebrow': 'üìú A√ß√£o Imediata',
          'title': 'Novo Manuscrito',
          'description': 'Invoque o Ritual de Cataloga√ß√£o e conceda vida digital aos novos tesouros liter√°rios que adentrarem teu santu√°rio pessoal.',
          'meta': '√öltima adi√ß√£o: ' ~ (current_user.last_book_added.acquisition_date|timeago if current_user.last_book_added else 'Nenhum livro ainda'),
          'cta_text': 'Iniciar Ritual ‚ú®',
          'cta_url': '/register_new_book',
          'cta_label': 'Invocar ritual de cataloga√ß√£o',
          'image': 'images/novo-manuscrito.jpg',
          'image_alt': 'Pergaminho sendo escrito com pena dourada',
          'featured': false,
          'placeholder_class': 'card-media-placeholder--manuscript',
          'placeholder_emoji': 'üìú'
        },
        {
          'id': 'auth-card-title-2',
          'eyebrow': 'üèõÔ∏è Seu Reino',
          'title': 'Sal√£o dos Tesouros',
          'description': 'Contemple teu imp√©rio de ' ~ (current_user.books|length) ~ ' tomos sagrados e ' ~ current_user.sum_pages ~ ' p√°ginas de sabedoria conquistada.',
          'meta': (current_user.books|length) ~ ' livros ‚Ä¢ ' ~ current_user.sum_pages ~ ' p√°ginas',
          'cta_text': 'Abrir o Cofre üìö',
          'cta_url': '/your_collection',
          'cta_label': 'Adentrar o sal√£o dos tesouros',
          'image': 'images/colecao-pessoal.jpg',
          'image_alt': 'Biblioteca pessoal com ' ~ (current_user.books|length) ~ ' livros organizados',
          'featured': true,
          'placeholder_class': 'card-media-placeholder--collection',
          'placeholder_emoji': 'üìö'
        },
        {
          'id': 'auth-card-title-3',
          'eyebrow': 'üîç Ferramenta Ativa',
          'title': 'Busca M√≠stica',
          'description': 'Desperte teu <span lang="en">Sherlock Holmes</span> interior e encontre qualquer volume perdido nos labirintos de tua cole√ß√£o com precis√£o supernatural.',
          'meta': '√öltima busca: ' ~ (session.get('last_search_term', 'Nenhuma ainda')),
          'cta_text': 'Elementary! üïµÔ∏è',
          'cta_url': '/search',
          'cta_label': 'Iniciar busca m√≠stica',
          'image': 'images/busca-ativa.jpg',
          'image_alt': 'Lupa m√°gica brilhando sobre uma biblioteca',
          'featured': false,
          'placeholder_class': 'card-media-placeholder--search',
          'placeholder_emoji': 'üîç'
        },
        {
          'id': 'auth-card-title-4',
          'eyebrow': 'üìä Insights Pessoais',
          'title': 'Or√°culo Pessoal',
          'description': 'Consulta as T√°buas da Sabedoria e desvenda os padr√µes ocultos de tua jornada liter√°ria atrav√©s de vis√µes estat√≠sticas ancestrais.',
          'meta': 'G√™nero favorito: ' ~ (current_user.favorite_genre[0] if current_user.favorite_genre else 'Ainda descobrindo'),
          'cta_text': 'Revelar Segredos üîÆ',
          'cta_url': '/about_your_library',
          'cta_label': 'Consultar o or√°culo pessoal',
          'image': 'images/estatisticas-pessoais.jpg',
          'image_alt': 'Gr√°ficos m√≠sticos mostrando padr√µes de leitura',
          'featured': false,
          'placeholder_class': 'card-media-placeholder--stats',
          'placeholder_emoji': 'üìä'
        }
      ] %}

      {{ features_grid(authenticated_features) }}

      {# Developer card removed from authenticated view - shown only for unauthenticated users #}
    </div>
  </section>

  <!-- Se√ß√£o de Livros em Destaque (Implementa√ß√£o futura com dados reais) -->
  {#
  {% if featured_books %}
    {{ featured_books_section(featured_books) }}
  {% endif %}
  #}
</main>
{% endif %}

{% endblock %}
